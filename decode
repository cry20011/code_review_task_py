import argparse
import textfuncs


alph = "abcdefghijklmnopqrstuvwxyz"


def decode_caesar(text, key):
    key = int(key)
    chiper = ""
    for c in text:
        chiper += alph[(alph.index(c) - key) % len(alph)]

    return chiper

def decode_vigenere(text, key):
    chiper = ""
    for i in range(len(text)):
        key_pos = i % len(key)
        chiper += alph[(alph.index(text[i]) - alph.index(key[key_pos])) 
                        % len(alph)]

    return chiper



parser = argparse.ArgumentParser()

parser.add_argument("--chiper")
parser.add_argument("--key")
parser.add_argument("--input-file")
parser.add_argument("--output-file")
args = parser.parse_args()


chiper = textfuncs.input_text(args.input_file)
chiper = textfuncs.tolower_onlyletters(chiper)

if args.chiper == "caesar":
    text = decode_caesar(chiper, args.key)
elif args.chiper == "vigenere":
    text = decode_vigenere(chiper, args.key)

textfuncs.print_text(text, args.output_file)
